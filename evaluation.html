<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart Evaluation System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Chart Evaluation System</h1>
            <p class="subtitle">Evaluate charts across different cognitive constructs</p>
        </header>

        <!-- Static Navigation Tabs -->
        <div class="category-navigation">
            <button class="nav-tab active" id="clutterTab" onclick="showCategory('clutter')">Visual Clutter Evaluation</button>
            <button class="nav-tab" id="cognitiveTab" onclick="showCategory('cognitive_load')">Cognitive Load Evaluation</button>
            <button class="nav-tab" id="interpretabilityTab" onclick="showCategory('interpretability')">Interpretability Evaluation</button>
            <button class="nav-tab" id="styleTab" onclick="showCategory('style')">Style Evaluation</button>
        </div>

        <!-- Master Question Section -->
        <div class="master-question-section">
            <h2 class="master-question-title">Master Question</h2>
            <div class="dataset-info">
                <strong>Dataset:</strong> Inc5000 Company List 2014<br>
                <strong>Target Audience:</strong> Business executives, investors, and strategic planners
            </div>
            <p class="master-question-text">
                <strong>Which industries consistently produce the highest-growth companies across different states, and are there regional patterns worth exploring?</strong>
            </p>
            <div class="curator-context">
                <em>Context: Encourage decision makers to analyze high-growth sectors for potential investment, benchmarking, or location-based strategic expansion.</em>
            </div>
            <div class="assumption-note">
                <strong>Important:</strong> Both charts show visualizations of the same underlying dataset; only the visual design elements differ.
            </div>
        </div>

        <!-- Visual Clutter Guidelines -->
        <div class="guidelines-section" id="clutterGuidelines">
            <h3>User Guidelines for Visual Clutter</h3>
            <div class="guidelines-content">
                <div class="instruction-summary">
                    <h4>What to do:</h4>
                    <ul>
                        <li>Imagine seeing this chart for the first time for just 1â€“2 seconds, with some initial impressions to gauge the purpose of the visualization.</li>
                        <li>Focus on <strong>Purely Visual</strong> perceptions. Is it a chart you would make an effort to parse in more detail?</li>
                        <li>For this question, <strong>Do NOT</strong> try to decode the specific data values plotted, nor any underlying patterns/insights.</li>
                        <li>Look only at the visible elements on the chart surface, their arrangement, and how they interact with each other.</li>
                    </ul>
                </div>
                
                <div class="what-to-focus">
                    <h4>What to focus on:</h4>
                    <ul>
                        <li>Dense labels, overlapping text, or crowded annotations</li>
                        <li>Heavy gridlines, excessive visual elements, or visually impeding decorative components</li>
                        <li>Overall visual noise and element density at first glance</li>
                        <li>Whether the chart feels overwhelming or calm to look at initially</li>
                    </ul>
                </div>
                
                <div class="what-to-ignore">
                    <h4>What to ignore:</h4>
                    <ul>
                        <li>The actual data values or trends shown in the chart</li>
                        <li>Your ability to understand the chart's message</li>
                        <li>Whether the chart is "good" or "bad" from an analytical perspective</li>
                        <li>The complexity of the underlying data or domain</li>
                    </ul>
                </div>
                
                <div class="decision-heuristic">
                    <h4>Decision Heuristic:</h4>
                    <p><strong>Pick the chart that looks cleaner and less overwhelming at first glance, regardless of the data it shows.</strong></p>
                </div>
                
                <div class="design-flaws">
                    <h4>Possible Design Flaw Tags You May Look For:</h4>
                    <div class="flaw-category">
                        <strong>Dense Text/Labels:</strong> Overlapping labels, cramped annotations, excessive text density
                    </div>
                    <div class="flaw-category">
                        <strong>Heavy Visual Elements:</strong> Thick gridlines, excessive borders, heavy chart junk
                    </div>
                    <div class="flaw-category">
                        <strong>Decorative Overload:</strong> Unnecessary visual embellishments, distracting design elements
                    </div>
                    <div class="flaw-category">
                        <strong>Color/Pattern Noise:</strong> Too many colors, conflicting patterns, visual interference
                    </div>
                </div>
            </div>
        </div>

        <!-- Cognitive Load Guidelines -->
        <div class="guidelines-section" id="cognitiveGuidelines" style="display: none;">
            <h3>User Guidelines for Cognitive Load (Extraneous)</h3>
            <div class="guidelines-content">
                <div class="instruction-summary">
                    <h4>What to do:</h4>
                    <ul>
                        <li>Assume both charts show the same data; focus only on which design makes comprehension easier or harder.</li>
                        <li>Answer based on the mental effort needed to identify key values/trends/comparisonsâ€”NOT on which chart you personally find prettier.</li>
                        <li>Consider how quickly you can locate the legend/labels, understand encodings, and interpret scales.</li>
                    </ul>
                </div>
                
                <div class="what-to-focus">
                    <h4>What to focus on:</h4>
                    <ul>
                        <li>How many distinct visual cues you must track at once (color, size, shape, annotations, multiple legends).</li>
                        <li>Whether you need to repeatedly switch attention between legend, labels, and marks to decode meaning.</li>
                        <li>Whether the chart feels visually crowded or forces slow scanning.</li>
                        <li>Scale complexity (dual y-axes, non-uniform spacing, multiple scales requiring constant checking)</li>
                        <li>Legend/decoding overhead - how much back-and-forth eye movement is needed</li>
                    </ul>
                </div>
                
                <div class="what-to-ignore">
                    <h4>What to ignore:</h4>
                    <ul>
                        <li>Your familiarity with the topic/domain of the data (assume neutral).</li>
                        <li>Whether you like the style aesthetically (unless it directly increases confusion or effort).</li>
                        <li>Whether the data itself is complex (judge the design's added burden).</li>
                    </ul>
                </div>
                
                <div class="decision-heuristic">
                    <h4>Decision Heuristic:</h4>
                    <p><strong>Pick the chart that you believe a typical viewer could understand faster with fewer back-and-forth eye movements.</strong></p>
                </div>
                
                <div class="design-flaws">
                    <h4>Possible Design Flaw Tags You May Look For:</h4>
                    <div class="flaw-category">
                        <strong>Multiple Visual Channels:</strong> Too many encodings to track (color + size + shape + pattern)
                    </div>
                    <div class="flaw-category">
                        <strong>Legend/Decoding Overhead:</strong> Complex legends requiring constant reference
                    </div>
                    <div class="flaw-category">
                        <strong>Scale Complexity:</strong> Dual axes, non-uniform spacing, multiple scales
                    </div>
                    <div class="flaw-category">
                        <strong>Attention Switching:</strong> Frequent eye movement between elements needed for comprehension
                    </div>
                </div>
            </div>
        </div>

        <!-- Interpretability Guidelines -->
        <div class="guidelines-section" id="interpretabilityGuidelines" style="display: none;">
            <h3>User Guidelines for Interpretability (Confusion / Ambiguity)</h3>
            <div class="guidelines-content">
                <div class="instruction-summary">
                    <h4>What to do:</h4>
                    <ul>
                        <li>Try to understand what the chart is communicating, using given context and knowledge.</li>
                        <li>Decoding is allowed and expected (axes, legends, colors). First, try to comprehend each element (such as axes scales, legends, annotations etc.) and their properties (underlying data type, size, color, etc.) independently.</li>
                        <li>Try performing retrieval of data values, such as exact numbers or trends.</li>
                        <li>Judge whether the any individual element, or a combination of elements on the chart leads to a clear or ambiguous understanding.</li>
                    </ul>
                </div>
                
                <div class="what-to-focus">
                    <h4>What to focus on:</h4>
                    <ul>
                        <li>Whether you can clearly tell what each visual element represents without confusion.</li>
                        <li>Whether relationships, comparisons, or trends are unambiguous.</li>
                        <li>Whether multiple plausible interpretations exist (in which case, it would decrease interpretability and lead to confusion).</li>
                        <li>Ambiguous visual encodings (same color for multiple categories, unclear legends, inconsistent use of symbols).</li>
                        <li>Missing or unclear axis labels, units, or scales.</li>
                        <li>Using your own knowledge and information about underlying data (data types, semantic meanings etc.), check if the used encodings or scales make sense. </li> 
                    </ul>
                </div>
                
                <div class="what-to-ignore">
                    <h4>What to ignore:</h4>
                    <ul>
                        <li>Judging based on visual crowdedness alone (that is clutter).</li>
                        <li>Judging based on how effortful decoding felt (that is cognitive load or data domain complexity).</li>
                        <li>Aesthetic preferences unrelated to clarity.</li>
                    </ul>
                </div>
                
                <div class="decision-heuristic">
                    <h4>Decision Heuristic:</h4>
                    <p><strong>If two reasonable people could walk away with different understandings, the chart is less interpretable.</strong></p>
                    <p><strong>Pick the chart that is both "unambiguous" and "useful" in what it is conveying. </strong></p>
                </div>
                
                <div class="design-flaws">
                    <h4>Possible Design Flaw Tags You May Look For:</h4>
                    <div class="flaw-category">
                        <strong>Ambiguous/Confusing Visual Encoding:</strong> Same color for multiple categories, unclear symbol meanings, continuous color encoding for discrete variables etc.
                    </div>
                    <div class="flaw-category">
                        <strong>Missing/Unclear Labels:</strong> Unlabeled axes, missing units, ambiguous legends
                    </div>
                    <div class="flaw-category">
                        <strong>Misleading/Confusing Scales:</strong> Non-zero baselines, inconsistent intervals, truncated ranges, or logarithmic scales/transformations without clear indication OR utility.
                    </div>
                    <div class="flaw-category">
                        <strong>Inconsistent Mapping:</strong> Same visual element representing different data types
                    </div>
                </div>
            </div>
        </div>

        <!-- Style Guidelines -->
        <div class="guidelines-section" id="styleGuidelines" style="display: none;">
            <h3>User Guidelines for Style (Aesthetic Appeal)</h3>
            <div class="guidelines-content">
                <div class="instruction-summary">
                    <h4>What to do:</h4>
                    <ul>
                        <li>Focus purely on visual aesthetics and design appeal (choice of font, color and other design attributes etc.).</li>
                        <li>Judge the rationality of spatial layout, element positioning, size proportions and spacing from a design perspective for the particular type of chart presented (bar chart, line chart, etc.).</li>
                        <li>Consider which chart you find to be better, more professionally designed for the given intent.</li>
                        <li>Judge based on overall visual harmony, color choices, and design quality.</li>
                    </ul>
                </div>
                
                <div class="what-to-focus">
                    <h4>What to focus on:</h4>
                    <ul>
                        <li>Color harmony and visual appeal of the palette.</li>
                        <li>Typography quality and readability.</li>
                        <li>Overall design professionalism and polish.</li>
                        <li>Visual balance and composition.</li>
                        <li>Modern vs. outdated design elements.</li>
                    </ul>
                </div>
                
                <div class="what-to-ignore">
                    <h4>What to ignore:</h4>
                    <ul>
                        <li>Functional aspects like data clarity or ease of interpretation.</li>
                        <li>How cluttered or clean the chart appears functionally.</li>
                        <li>How easy it is to understand the data, the problem domain, its technicality etc.</li>
                    </ul>
                </div>
                
                <div class="decision-heuristic">
                    <h4>Decision Heuristic:</h4>
                    <p><strong>Pick the chart that you would be more proud to include in a professional presentation based purely on visual appeal.</strong></p>
                </div>
                
                <div class="design-flaws">
                    <h4>Possible Design Flaw Tags You May Look For:</h4>
                    <div class="flaw-category">
                        <strong>Poor Color Harmony:</strong> Clashing colors, inappropriate palette choices, poor contrast
                    </div>
                    <div class="flaw-category">
                        <strong>Typography Issues:</strong> Poor font choices, inconsistent sizing, readability problems
                    </div>
                    <div class="flaw-category">
                        <strong>Layout Problems:</strong> Poor spacing, unbalanced composition, misaligned elements
                    </div>
                    <div class="flaw-category">
                        <strong>Outdated Design:</strong> Old-fashioned styling, dated visual elements, unprofessional appearance
                    </div>
                </div>
            </div>
        </div>

        <div class="images-section">
            <div class="charts-row">
                <div class="image-container">
                    <div class="image-card" id="imageCard1">
                        <div class="image-header">
                            <h3 id="imageTitle1">Chart A</h3>
                            <div class="score" id="imageScore1"></div>
                        </div>
                        <div class="image-placeholder" id="image1">
                            <img id="chartA" src="" alt="Chart A" class="chart-image" style="display: none; max-width: 100%; height: auto;">
                            <div class="placeholder-text" id="placeholderA">Loading Chart A...</div>
                        </div>
                        <!-- <div class="metrics">
                            <div class="metric-row">
                                <span>Dense labels</span>
                                <span>Heavy gridlines</span>
                                <span>Decorative elements</span>
                            </div>
                        </div>
                        <p class="description" id="description1">
                            [Chart A - Contains various visual elements that may contribute to clutter]
                        </p> -->
                    </div>
                </div>

                <div class="image-container">
                    <div class="image-card" id="imageCard2">
                        <div class="image-header">
                            <h3 id="imageTitle2">Chart B</h3>
                            <div class="score" id="imageScore2"></div>
                        </div>
                        <div class="image-placeholder" id="image2">
                            <img id="chartB" src="" alt="Chart B" class="chart-image" style="display: none; max-width: 100%; height: auto;">
                            <div class="placeholder-text" id="placeholderB">Loading Chart B...</div>
                        </div>
                        <!-- <div class="metrics">
                            <div class="metric-row">
                                <span>Minimal labels</span>
                                <span>Reduced ink</span>
                                <span>Clean design</span>
                            </div>
                        </div>
                        <p class="description" id="description2">
                            [Chart B - Features simplified visual design with fewer elements]
                        </p> -->
                    </div>
                </div>
            </div>
            
            <!-- Navigation controls will be inserted here by JavaScript -->
            <div id="pairNavigationContainer"></div>
        </div>

        <!-- Visual Clutter Evaluation Form -->
        <div class="question-form" id="clutterForm">
            <div class="primary-question">
                <h3>Which chart looks more cluttered or visually messy?</h3>
                <p class="clarifying-subtitle">Focus on visual crowding and noise, not data complexity</p>
                
                <div class="forced-choice">
                    <label><input type="radio" name="primary_clutter" value="Chart A"> Chart A looks more cluttered</label>
                    <label><input type="radio" name="primary_clutter" value="Chart B"> Chart B looks more cluttered</label>
                    <label><input type="radio" name="primary_clutter" value="About the same"> About the same</label>
                </div>
            </div>

            <div class="likert-questions">
                <h4>Rate each chart's visual clutter level:</h4>
                
                <div class="likert-group">
                    <label class="likert-label">Chart A visual clutter:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_clutter" value="1">
                                <div class="option-content">
                                    <strong>1. Minimal Clutter</strong>
                                    <span>Clean design with excellent visual hierarchy</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_clutter" value="2">
                                <div class="option-content">
                                    <strong>2. Isolated Issues</strong>
                                    <span>One or two clutter elements, but message comes through</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_clutter" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Issues</strong>
                                    <span>Several clutter elements creating visual noise, objective hard to track</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_clutter" value="4">
                                <div class="option-content">
                                    <strong>4. Severely Cluttered</strong>
                                    <span>Chart should be discarded due to excessive visual noise</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="likert-group">
                    <label class="likert-label">Chart B visual clutter:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_clutter" value="1">
                                <div class="option-content">
                                    <strong>1. Minimal Clutter</strong>
                                    <span>Clean design with excellent visual hierarchy</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_clutter" value="2">
                                <div class="option-content">
                                    <strong>2. Isolated Issues</strong>
                                    <span>One or two clutter elements, but message comes through</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_clutter" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Issues</strong>
                                    <span>Several clutter elements creating visual noise, objective hard to track</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_clutter" value="4">
                                <div class="option-content">
                                    <strong>4. Severely Cluttered</strong>
                                    <span>Chart should be discarded due to excessive visual noise</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="confidence-question">
                <h4>How confident are you in your choice?</h4>
                <div class="likert-scale confidence-scale">
                    <span class="scale-label">Not confident<br>(1)</span>
                    <div class="radio-group">
                        <label><input type="radio" name="confidence_clutter" value="1"><span>1</span></label>
                        <label><input type="radio" name="confidence_clutter" value="2"><span>2</span></label>
                        <label><input type="radio" name="confidence_clutter" value="3"><span>3</span></label>
                        <label><input type="radio" name="confidence_clutter" value="4"><span>4</span></label>
                        <label><input type="radio" name="confidence_clutter" value="5"><span>5</span></label>
                    </div>
                    <span class="scale-label">Very confident<br>(5)</span>
                </div>
            </div>

            <div class="rationale-question">
                <h4>Briefly explain what made your chosen chart look more/less cluttered (optional):</h4>
                <textarea id="rationale_clutter" rows="3" placeholder="E.g., 'Chart A has overlapping labels and heavy gridlines...'" maxlength="500"></textarea>
            </div>
            
            <div class="form-actions">
                <button type="button" class="save-btn" onclick="saveClutterResponses()">ðŸ’¾ Save Clutter Responses</button>
                <button type="button" class="submit-btn" onclick="submitEvaluation('clutter')">Submit Clutter Evaluation</button>
            </div>
        </div>

        <!-- Cognitive Load Evaluation Form -->
        <div class="question-form" id="cognitiveForm" style="display: none;">
            <div class="primary-question">
                <h3>Which chart feels less mentally heavy to understand at a glance?</h3>
                <p class="clarifying-subtitle">Focus on design-induced mental effort, not data complexity</p>
                
                <div class="forced-choice">
                    <label><input type="radio" name="primary_cognitive_load" value="Chart A"> Chart A requires less mental effort</label>
                    <label><input type="radio" name="primary_cognitive_load" value="Chart B"> Chart B requires less mental effort</label>
                    <label><input type="radio" name="primary_cognitive_load" value="About the same"> About the same</label>
                </div>
            </div>

            <div class="likert-questions">
                <h4>Rate each chart's cognitive load level:</h4>
                
                <div class="likert-group">
                    <label class="likert-label">Chart A cognitive load:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_cognitive" value="1">
                                <div class="option-content">
                                    <strong>1. Minimal Cognitive Load</strong>
                                    <span>Very easy to process, excellent parsing efficiency</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_cognitive" value="2">
                                <div class="option-content">
                                    <strong>2. Isolated Complexity</strong>
                                    <span>One or two demanding elements, but comprehensible</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_cognitive" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Demanding Elements</strong>
                                    <span>Several features requiring significant mental effort, not easily digestible</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_cognitive" value="4">
                                <div class="option-content">
                                    <strong>4. Excessive Cognitive Burden</strong>
                                    <span>Chart should be discarded due to overwhelming complexity</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="likert-group">
                    <label class="likert-label">Chart B cognitive load:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_cognitive" value="1">
                                <div class="option-content">
                                    <strong>1. Minimal Cognitive Load</strong>
                                    <span>Very easy to process, excellent design efficiency</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_cognitive" value="2">
                                <div class="option-content">
                                    <strong>2. Isolated Complexity</strong>
                                    <span>One or two demanding elements, but comprehensible</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_cognitive" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Demanding Elements</strong>
                                    <span>Several features requiring significant mental effort, not easily digestible</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_cognitive" value="4">
                                <div class="option-content">
                                    <strong>4. Excessive Cognitive Burden</strong>
                                    <span>Chart should be discarded due to overwhelming complexity</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="confidence-question">
                <h4>How confident are you in your choice?</h4>
                <div class="likert-scale confidence-scale">
                    <span class="scale-label">Not confident<br>(1)</span>
                    <div class="radio-group">
                        <label><input type="radio" name="confidence_cognitive" value="1"><span>1</span></label>
                        <label><input type="radio" name="confidence_cognitive" value="2"><span>2</span></label>
                        <label><input type="radio" name="confidence_cognitive" value="3"><span>3</span></label>
                        <label><input type="radio" name="confidence_cognitive" value="4"><span>4</span></label>
                        <label><input type="radio" name="confidence_cognitive" value="5"><span>5</span></label>
                    </div>
                    <span class="scale-label">Very confident<br>(5)</span>
                </div>
            </div>

            <div class="rationale-question">
                <h4>Briefly explain what made your chosen chart feel easier/harder to parse (optional):</h4>
                <textarea id="rationale_cognitive" rows="3" placeholder="E.g., 'Chart A has too many visual channels to track simultaneously...'" maxlength="500"></textarea>
            </div>
            
            <div class="form-actions">
                <button type="button" class="save-btn" onclick="saveCognitiveResponses()">ðŸ’¾ Save Cognitive Load Responses</button>
                <button type="button" class="submit-btn" onclick="submitEvaluation('cognitive_load')">Submit Cognitive Load Evaluation</button>
            </div>
        </div>

        <!-- Interpretability Evaluation Form -->
        <div class="question-form" id="interpretabilityForm" style="display: none;">
            <div class="primary-question">
                <h3>Which chart is easier to understand correctly and unambiguously?</h3>
                <p class="clarifying-subtitle">Assume you are trying to understand what the chart is telling you</p>
                
                <div class="forced-choice">
                    <label><input type="radio" name="primary_interpretability" value="Chart A"> Chart A is more interpretable</label>
                    <label><input type="radio" name="primary_interpretability" value="Chart B"> Chart B is more interpretable</label>
                    <label><input type="radio" name="primary_interpretability" value="About the same"> About the same</label>
                </div>
            </div>

            <div class="likert-questions">
                <h4>Rate each chart's interpretability level:</h4>
                
                <div class="likert-group">
                    <label class="likert-label">Chart A interpretability:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_interpretability" value="1">
                                <div class="option-content">
                                    <strong>1. Highly Interpretable</strong>
                                    <span>Crystal clear meaning, no ambiguity or confusion from any element</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_interpretability" value="2">
                                <div class="option-content">
                                    <strong>2. Minor Ambiguity</strong>
                                    <span>Some ambiguous elements identified, but overall message clear</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_interpretability" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Confusing Elements</strong>
                                    <span>Combination of several aspects create confusion or misinterpretation risk</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_interpretability" value="4">
                                <div class="option-content">
                                    <strong>4. Severely Ambiguous</strong>
                                    <span>Chart should be discarded due to unclear interpretation</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="likert-group">
                    <label class="likert-label">Chart B interpretability:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_interpretability" value="1">
                                <div class="option-content">
                                    <strong>1. Highly Interpretable</strong>
                                    <span>Crystal clear meaning, no ambiguity or confusion</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_interpretability" value="2">
                                <div class="option-content">
                                    <strong>2. Minor Ambiguity</strong>
                                    <span>Some ambiguous elements identified, but overall message clear</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_interpretability" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Confusing Elements</strong>
                                    <span>Combination of several aspects create confusion or misinterpretation risk</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_interpretability" value="4">
                                <div class="option-content">
                                    <strong>4. Severely Ambiguous</strong>
                                    <span>Chart should be discarded due to unclear interpretation</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="confidence-question">
                <h4>How confident are you that your understanding is correct?</h4>
                <div class="likert-scale confidence-scale">
                    <span class="scale-label">Not confident<br>(1)</span>
                    <div class="radio-group">
                        <label><input type="radio" name="confidence_interpretability" value="1"><span>1</span></label>
                        <label><input type="radio" name="confidence_interpretability" value="2"><span>2</span></label>
                        <label><input type="radio" name="confidence_interpretability" value="3"><span>3</span></label>
                        <label><input type="radio" name="confidence_interpretability" value="4"><span>4</span></label>
                        <label><input type="radio" name="confidence_interpretability" value="5"><span>5</span></label>
                    </div>
                    <span class="scale-label">Very confident<br>(5)</span>
                </div>
            </div>

            <div class="rationale-question">
                <h4>Briefly explain what made the chart clear or confusing (optional):</h4>
                <textarea id="rationale_interpretability" rows="3" placeholder="E.g., 'Chart A has ambiguous color mapping and unclear axes...'" maxlength="500"></textarea>
            </div>
            
            <div class="form-actions">
                <button type="button" class="save-btn" onclick="saveInterpretabilityResponses()">ðŸ’¾ Save Interpretability Responses</button>
                <button type="button" class="submit-btn" onclick="submitEvaluation('interpretability')">Submit Interpretability Evaluation</button>
            </div>
        </div>

        <!-- Style Evaluation Form -->
        <div class="question-form" id="styleForm" style="display: none;">
            <div class="primary-question">
                <h3>Which chart is more visually appealing and professionally designed?</h3>
                <p class="clarifying-subtitle">Focus purely on aesthetic appeal and design quality</p>
                
                <div class="forced-choice">
                    <label><input type="radio" name="primary_style" value="Chart A"> Chart A looks better designed</label>
                    <label><input type="radio" name="primary_style" value="Chart B"> Chart B looks better designed</label>
                    <label><input type="radio" name="primary_style" value="About the same"> About the same</label>
                </div>
            </div>

            <div class="likert-questions">
                <h4>Rate each chart's aesthetic appeal and design quality:</h4>
                
                <div class="likert-group">
                    <label class="likert-label">Chart A style quality:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_style" value="1">
                                <div class="option-content">
                                    <strong>1. Excellent Design</strong>
                                    <span>Professional, polished, and visually compelling</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_style" value="2">
                                <div class="option-content">
                                    <strong>2. Minor Design Issues</strong>
                                    <span>Generally good with a few identifiable style problems</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_style" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Style Problems</strong>
                                    <span>Several aesthetic issues affecting visual appeal, not easily digestible</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_a_style" value="4">
                                <div class="option-content">
                                    <strong>4. Poor Design Quality</strong>
                                    <span>Chart should be discarded due to unprofessional appearance</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="likert-group">
                    <label class="likert-label">Chart B style quality:</label>
                    <div class="descriptive-scale">
                        <div class="scale-options">
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_style" value="1">
                                <div class="option-content">
                                    <strong>1. Excellent Design</strong>
                                    <span>Professional, polished, and visually compelling</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_style" value="2">
                                <div class="option-content">
                                    <strong>2. Minor Design Issues</strong>
                                    <span>Generally good with a few identifiable style problems</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_style" value="3">
                                <div class="option-content">
                                    <strong>3. Multiple Style Problems</strong>
                                    <span>Several aesthetic issues affecting visual appeal, not easily digestible</span>
                                </div>
                            </label>
                            <label class="descriptive-option">
                                <input type="radio" name="chart_b_style" value="4">
                                <div class="option-content">
                                    <strong>4. Poor Design Quality</strong>
                                    <span>Chart should be discarded due to unprofessional appearance</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="confidence-question">
                <h4>How confident are you in your aesthetic judgment?</h4>
                <div class="likert-scale confidence-scale">
                    <span class="scale-label">Not confident<br>(1)</span>
                    <div class="radio-group">
                        <label><input type="radio" name="confidence_style" value="1"><span>1</span></label>
                        <label><input type="radio" name="confidence_style" value="2"><span>2</span></label>
                        <label><input type="radio" name="confidence_style" value="3"><span>3</span></label>
                        <label><input type="radio" name="confidence_style" value="4"><span>4</span></label>
                        <label><input type="radio" name="confidence_style" value="5"><span>5</span></label>
                    </div>
                    <span class="scale-label">Very confident<br>(5)</span>
                </div>
            </div>

            <div class="rationale-question">
                <h4>Briefly explain what makes one chart more visually appealing (optional):</h4>
                <textarea id="rationale_style" rows="3" placeholder="E.g., 'Chart A has better color harmony and typography...'" maxlength="500"></textarea>
            </div>
            
            <div class="form-actions">
        <!-- Style Evaluation Category -->
        <div class="evaluation-category" id="style" style="display: none;">
            <div class="images-section">
                <h2>Chart Comparison</h2>
                <div class="chart-container">
                    <div class="chart-item">
                        <h3>Chart A</h3>
                        <img id="styleChartA" src="" alt="Chart A" class="chart-image">
                    </div>
                    <div class="chart-item">
                        <h3>Chart B</h3>
                        <img id="styleChartB" src="" alt="Chart B" class="chart-image">
                    </div>
                </div>
            </div>

            <!-- Style Questions -->
            <div class="question-form">
                <div class="question-group">
                    <label class="question-text">Which chart better aligns with established design conventions for professional business presentations?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="style_q1" value="A"> Chart A
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="style_q1" value="B"> Chart B
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="save-btn" onclick="saveStyleResponses()">ðŸ’¾ Save Style Responses</button>
                <button type="button" class="submit-btn" onclick="submitEvaluation('style')">Submit Style Evaluation</button>
            </div>
        </div>


    </div>

    <!-- Image Modal for Enlarged View -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
        <img id="modalImage" src="" alt="Enlarged view">
    </div>

    <script src="script_static_updated.js"></script>
    <script src="pair_processor.js"></script>
    <script>
        // Integrated Pair Loading System
        let currentPairProcessor = null;
        let currentPairIndex = 0;

        // Initialize pair loading on page load
        async function initializeIntegratedPairs() {
            try {
                console.log('Initializing integrated pair system...');
                const urlParams = new URLSearchParams(window.location.search);
                currentPairProcessor = new PairProcessor();
                await currentPairProcessor.initialize(urlParams);
                
                if (currentPairProcessor.allPairs.length > 0) {
                    console.log(`Found ${currentPairProcessor.allPairs.length} pairs`);
                    loadCurrentPair();
                    addNavigationControls();
                    addReturnToWelcomeButton();
                } else {
                    console.log('No pairs found for the selected criteria');
                    showNoPairsMessage();
                }
            } catch (error) {
                console.error('Failed to initialize pairs:', error);
                showErrorMessage();
            }
        }

        // Load current pair into Chart A and Chart B
        function loadCurrentPair() {
            const currentPair = currentPairProcessor.allPairs[currentPairIndex];
            if (!currentPair || currentPair.images.length < 2) {
                console.warn('Current pair does not have enough images');
                return;
            }

            const chartA = document.getElementById('chartA');
            const chartB = document.getElementById('chartB');
            const placeholderA = document.getElementById('placeholderA');
            const placeholderB = document.getElementById('placeholderB');
            
            // Update dataset info
            updateDatasetInfo(currentPair);
            
            // Initialize pair evaluation system
            initializePairEvaluation(currentPair.id, currentPair.metadata);
            
            // Clear previous form responses when switching pairs
            clearFormResponses();
            
            // Load first image as Chart A
            if (currentPair.images[0]) {
                chartA.src = currentPair.images[0].fullUrl;
                chartA.onload = function() {
                    chartA.style.display = 'block';
                    placeholderA.style.display = 'none';
                };
                chartA.onerror = function() {
                    placeholderA.textContent = 'Chart A - Image not found';
                };
            }
            
            // Load second image as Chart B
            if (currentPair.images[1]) {
                chartB.src = currentPair.images[1].fullUrl;
                chartB.onload = function() {
                    chartB.style.display = 'block';
                    placeholderB.style.display = 'none';
                };
                chartB.onerror = function() {
                    placeholderB.textContent = 'Chart B - Image not found';
                };
            }
            
            // Update descriptions
            updatePairInfo(currentPair);
            
            // Load saved responses for current category
            loadSavedResponsesForCurrentPair(currentCategory);
        }
        
        // Update dataset information
        function updateDatasetInfo(pair) {
            const datasetInfo = document.querySelector('.dataset-info');
            if (datasetInfo) {
                datasetInfo.innerHTML = `
                    <strong>Dataset:</strong> ${pair.metadata.dataset}<br>
                    <strong>Summary/Question:</strong> ${pair.metadata.summary} - ${pair.metadata.question}<br>
                    <strong>Pair:</strong> ${pair.pairDir}
                `;
            }
        }
        
        // Update pair information
        function updatePairInfo(pair) {
            const description1 = document.getElementById('description1');
            const description2 = document.getElementById('description2');
            
            if (description1) {
                description1.textContent = `Chart A from ${pair.metadata.dataset} - ${pair.images[0]?.name || 'Image 1'}`;
            }
            
            if (description2) {
                description2.textContent = `Chart B from ${pair.metadata.dataset} - ${pair.images[1]?.name || 'Image 2'}`;
            }
        }

        // Add return to welcome button
        function addReturnToWelcomeButton() {
            const header = document.querySelector('header .container');
            if (header && !document.getElementById('returnToWelcome')) {
                const returnBtn = document.createElement('button');
                returnBtn.id = 'returnToWelcome';
                returnBtn.innerHTML = 'ðŸ  Back to Welcome';
                returnBtn.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 20px;
                    background: linear-gradient(135deg, #28a745, #20c997);
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 25px;
                    cursor: pointer;
                    font-weight: 600;
                    z-index: 1000;
                    box-shadow: 0 2px 10px rgba(40, 167, 69, 0.3);
                    transition: all 0.3s ease;
                `;
                returnBtn.onclick = function() {
                    if (confirm('Are you sure you want to return to the welcome page? Any unsaved progress will be lost.')) {
                        window.location.href = 'index.html';
                    }
                };
                returnBtn.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                    this.style.boxShadow = '0 4px 15px rgba(40, 167, 69, 0.4)';
                });
                returnBtn.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 2px 10px rgba(40, 167, 69, 0.3)';
                });
                document.body.appendChild(returnBtn);
            }
        }
        
        // Add navigation controls to the page
        function addNavigationControls() {
            // Always add navigation controls, even for single pairs to show context
            
            const navContainer = document.getElementById('pairNavigationContainer');
            if (navContainer) {
                const navControls = document.createElement('div');
                navControls.className = 'pair-navigation-controls';
                navControls.style.cssText = `
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    gap: 20px;
                    margin: 20px 0 0 0;
                    padding: 15px;
                    background: #f8f9fa;
                    border-radius: 8px;
                    border: 1px solid #e9ecef;
                `;
                
                const totalPairs = currentPairProcessor.allPairs.length;
                const completedPairs = Object.keys(allPairEvaluations).filter(pairId => {
                    const evaluation = allPairEvaluations[pairId];
                    return evaluation.completionStatus.clutter && evaluation.completionStatus.cognitive_load && 
                           evaluation.completionStatus.interpretability && evaluation.completionStatus.style;
                }).length;
                
                navControls.innerHTML = `
                    <button id="prevPair" onclick="navigatePair(-1)" style="
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 25px;
                        cursor: pointer;
                        font-weight: 600;
                        transition: all 0.3s ease;
                    ">â† Previous Pair</button>
                    
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 5px;">
                        <span id="pairCounter" style="
                            background: #fff;
                            padding: 8px 16px;
                            border-radius: 20px;
                            font-weight: 600;
                            color: #2c3e50;
                            border: 2px solid #e9ecef;
                        ">Pair ${currentPairIndex + 1} of ${totalPairs}</span>
                        <small style="color: #6c757d; font-size: 11px;">Completed: ${completedPairs}/${totalPairs}</small>
                    </div>
                    
                    <button id="nextPair" onclick="navigatePair(1)" style="
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 25px;
                        cursor: pointer;
                        font-weight: 600;
                        transition: all 0.3s ease;
                    ">Next Pair â†’</button>
                    
                    <button onclick="exportCurrentPairEvaluations()" style="
                        background: #28a745;
                        color: white;
                        border: none;
                        padding: 10px 15px;
                        border-radius: 20px;
                        cursor: pointer;
                        font-weight: 600;
                        font-size: 12px;
                        transition: all 0.3s ease;
                    ">ðŸ“¤ Export This Pair</button>
                    
                    <button onclick="exportAllPairEvaluations()" style="
                        background: #17a2b8;
                        color: white;
                        border: none;
                        padding: 10px 15px;
                        border-radius: 20px;
                        cursor: pointer;
                        font-weight: 600;
                        font-size: 12px;
                        transition: all 0.3s ease;
                    ">ðŸ“¦ Export All Pairs</button>
                `;
                
                navContainer.appendChild(navControls);
                updateNavigationButtons();
            }
        }
        
        // Navigate between pairs
        function navigatePair(direction) {
            const newIndex = currentPairIndex + direction;
            if (newIndex >= 0 && newIndex < currentPairProcessor.allPairs.length) {
                currentPairIndex = newIndex;
                loadCurrentPair();
                updateNavigationButtons();
            }
        }
        
        // Update navigation button states
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevPair');
            const nextBtn = document.getElementById('nextPair');
            const counter = document.getElementById('pairCounter');
            
            if (prevBtn) {
                prevBtn.disabled = currentPairIndex === 0;
                prevBtn.style.opacity = prevBtn.disabled ? '0.5' : '1';
                prevBtn.style.cursor = prevBtn.disabled ? 'not-allowed' : 'pointer';
            }
            
            if (nextBtn) {
                nextBtn.disabled = currentPairIndex === currentPairProcessor.allPairs.length - 1;
                nextBtn.style.opacity = nextBtn.disabled ? '0.5' : '1';
                nextBtn.style.cursor = nextBtn.disabled ? 'not-allowed' : 'pointer';
            }
            
            if (counter) {
                const totalPairs = currentPairProcessor.allPairs.length;
                const completedPairs = Object.keys(allPairEvaluations).filter(pairId => {
                    const evaluation = allPairEvaluations[pairId];
                    return evaluation.completionStatus.clutter && evaluation.completionStatus.cognitive_load && 
                           evaluation.completionStatus.interpretability && evaluation.completionStatus.style;
                }).length;
                
                counter.innerHTML = `
                    <span>Pair ${currentPairIndex + 1} of ${totalPairs}</span>
                    <small style="color: #6c757d; font-size: 11px; display: block;">Completed: ${completedPairs}/${totalPairs}</small>
                `;
                
                // Update counter styling based on completion
                if (completedPairs === totalPairs && totalPairs > 0) {
                    counter.style.background = '#d4edda';
                    counter.style.borderColor = '#28a745';
                    counter.style.color = '#155724';
                }
            }
        }

        // Show message when no pairs are found
        function showNoPairsMessage() {
            const placeholderA = document.getElementById('placeholderA');
            const placeholderB = document.getElementById('placeholderB');
            
            if (placeholderA) placeholderA.textContent = 'No image pairs found in pairs directory';
            if (placeholderB) placeholderB.textContent = 'No image pairs found in pairs directory';
        }

        // Show error message
        function showErrorMessage() {
            const placeholderA = document.getElementById('placeholderA');
            const placeholderB = document.getElementById('placeholderB');
            
            if (placeholderA) placeholderA.textContent = 'Error loading image pairs';
            if (placeholderB) placeholderB.textContent = 'Error loading image pairs';
        }

        // Add click event for modal view
        document.addEventListener('click', function(e) {
            if (e.target.id === 'chartA' || e.target.id === 'chartB') {
                openImageModal(e.target.src);
            }
        });
        
        // Image modal functions
        function openImageModal(imageSrc) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            if (modal && modalImg) {
                modal.classList.add('show');
                modalImg.src = imageSrc;
            }
        }

        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        // Initialize when DOM is ready - but only if accessed via proper navigation
        function conditionalInitialize() {
            const urlParams = new URLSearchParams(window.location.search);
            const hasDatasetParam = urlParams.get('dataset');
            const hasQuestionParam = urlParams.get('question');
            const referrer = document.referrer;
            
            // Only auto-initialize if we have proper URL parameters or came from dataset selector
            if (hasDatasetParam || hasQuestionParam || referrer.includes('dataset_selector.html')) {
                console.log('Valid navigation detected, initializing pairs...');
                initializeIntegratedPairs();
            } else {
                console.log('Direct access detected, redirecting to welcome page...');
                // Redirect to welcome page for proper navigation flow
                window.location.href = 'index.html';
            }
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', conditionalInitialize);
        } else {
            conditionalInitialize();
        }
    </script>
</body>
</html>